<ion-content [class.dark]="isDarkMode" class="transactions-content">
  <!-- Header -->
  <div class="header">
    <div class="header-content">
      <ion-button fill="clear" (click)="goBack()" class="back-btn">
        <ion-icon name="arrow-back" slot="icon-only"></ion-icon>
      </ion-button>
      <h1>Transações</h1>
      <div class="header-actions">
        <ion-button fill="clear" (click)="openTransactionModal('income')" class="add-btn">
          <ion-icon name="add" slot="icon-only"></ion-icon>
        </ion-button>
      </div>
    </div>
  </div>

  <!-- Filter Options -->
  <div class="filter-section">
    <div class="filter-options">
      <ion-button 
        fill="clear" 
        [class.active]="currentFilter === 'all'"
        (click)="setFilter('all')"
        class="filter-option">
        Todas
      </ion-button>
      <ion-button 
        fill="clear" 
        [class.active]="currentFilter === 'income'"
        (click)="setFilter('income')"
        class="filter-option">
        Receitas
      </ion-button>
      <ion-button 
        fill="clear" 
        [class.active]="currentFilter === 'expense'"
        (click)="setFilter('expense')"
        class="filter-option">
        Despesas
      </ion-button>
    </div>
  </div>

  <!-- Quick Add Buttons -->
  <div class="quick-add-section">
    <ion-button 
      expand="block" 
      fill="outline" 
      color="success"
      (click)="openTransactionModal('income')"
      class="quick-add-btn">
      <ion-icon name="add" slot="start"></ion-icon>
      Nova Receita
    </ion-button>
    <ion-button 
      expand="block" 
      fill="outline" 
      color="danger"
      (click)="openTransactionModal('expense')"
      class="quick-add-btn">
      <ion-icon name="remove" slot="start"></ion-icon>
      Nova Despesa
    </ion-button>
  </div>

  <!-- Transactions List -->
  <div class="transactions-list">
    <div *ngIf="getFilteredTransactions().length === 0" class="empty-state">
      <ion-icon name="receipt"></ion-icon>
      <h3>Nenhuma transação encontrada</h3>
      <p>{{ currentFilter === 'all' ? 'Adicione sua primeira transação usando os botões acima.' : 'Nenhuma transação encontrada para este filtro.' }}</p>
    </div>
    
    <div *ngFor="let transaction of getFilteredTransactions()" class="transaction-item">
      <div class="transaction-info">
        <div class="transaction-description">{{ transaction.description }}</div>
        <div class="transaction-category">{{ getCategoryName(transaction.category) }}</div>
        <div class="transaction-date">{{ formatDate(transaction.date) }}</div>
      </div>
      <div class="transaction-amount" [class.income]="transaction.type === 'income'" [class.expense]="transaction.type === 'expense'">
        {{ transaction.type === 'income' ? '+' : '-' }} {{ formatCurrency(transaction.amount) }}
      </div>
      <ion-button fill="clear" (click)="deleteTransaction(transaction.id)" class="delete-btn">
        <ion-icon name="trash" slot="icon-only"></ion-icon>
      </ion-button>
    </div>
  </div>

  <!-- Transaction Modal -->
  <div class="modal-overlay" *ngIf="showTransactionModal" (click)="closeTransactionModal()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>{{ transactionType === 'income' ? 'Nova Receita' : 'Nova Despesa' }}</h3>
        <ion-button fill="clear" (click)="closeTransactionModal()" class="close-btn">
          <ion-icon name="close" slot="icon-only"></ion-icon>
        </ion-button>
      </div>
      
      <form [formGroup]="transactionForm" (ngSubmit)="onSubmitTransaction()" class="transaction-form">
        <ion-item class="form-item">
          <ion-label position="stacked">Descrição</ion-label>
          <ion-input 
            formControlName="description" 
            placeholder="Ex: Salário, Aluguel, etc."
            type="text">
          </ion-input>
        </ion-item>
        
        <ion-item class="form-item">
          <ion-label position="stacked">Valor</ion-label>
          <ion-input 
            formControlName="amount" 
            placeholder="0,00"
            type="number"
            step="0.01">
          </ion-input>
        </ion-item>
        
        <ion-item class="form-item">
          <ion-label position="stacked">Categoria</ion-label>
          <ion-select formControlName="category" placeholder="Selecione uma categoria">
            <ion-select-option value="">Selecione uma categoria</ion-select-option>
            <ion-select-option value="salary">Salário</ion-select-option>
            <ion-select-option value="freelance">Freelance</ion-select-option>
            <ion-select-option value="investment">Investimento</ion-select-option>
            <ion-select-option value="food">Alimentação</ion-select-option>
            <ion-select-option value="transport">Transporte</ion-select-option>
            <ion-select-option value="housing">Moradia</ion-select-option>
            <ion-select-option value="entertainment">Entretenimento</ion-select-option>
            <ion-select-option value="health">Saúde</ion-select-option>
            <ion-select-option value="education">Educação</ion-select-option>
            <ion-select-option value="other">Outros</ion-select-option>
          </ion-select>
        </ion-item>
        
        <ion-item class="form-item">
          <ion-label position="stacked">Data</ion-label>
          <ion-input 
            formControlName="date" 
            type="date">
          </ion-input>
        </ion-item>
        
        <div class="form-actions">
          <ion-button fill="outline" (click)="closeTransactionModal()" class="btn-secondary">
            Cancelar
          </ion-button>
          <ion-button type="submit" [disabled]="!transactionForm.valid" class="btn-primary">
            Salvar
          </ion-button>
        </div>
      </form>
    </div>
  </div>
</ion-content>
